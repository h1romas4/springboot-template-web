buildscript {
	repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
	}
	dependencies {
        classpath 'org.springframework.boot:spring-boot-gradle-plugin:2.1.6.RELEASE'
        classpath "com.moowork.gradle:gradle-node-plugin:1.3.1"
	}
}

apply plugin: 'java'
apply plugin: 'org.springframework.boot'
apply plugin: 'io.spring.dependency-management'
apply plugin: 'com.moowork.node'
apply plugin: 'eclipse'

eclipse {
    classpath {
        defaultOutputDir = file('build/classes/java/main')
        // after Gradle 4.4
        // https://github.com/gradle/gradle/issues/3825
        file.whenMerged {
            entries.each { source ->
                if (source.kind == 'src' && source.toString().contains('output')) {
                    source.output = 'build/classes/java/main'
                }
            }
        }
    }
}

node {
    version = '10.16.0'
    download = true
}

task watch(dependsOn: ['npm_run_watch'])
task webpack(dependsOn: ['npm_run_webpack'])

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

def defaultEncoding = 'UTF-8'
[compileJava, compileTestJava]*.options*.encoding = defaultEncoding

bootRun {
    sourceResources sourceSets.main
}

repositories {
    jcenter()
}

dependencies {
    compile('org.springframework.boot:spring-boot-starter-web')
    compile('org.springframework.boot:spring-boot-starter-thymeleaf')
    compile("org.springframework.boot:spring-boot-devtools")
}
